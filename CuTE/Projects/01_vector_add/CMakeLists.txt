# Project 01: Vector Add - Standalone Build
cmake_minimum_required(VERSION 3.20)
project(project_01_vector_add LANGUAGES CXX CUDA)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CUDA_STANDARD 17)
set(CMAKE_CUDA_ARCHITECTURES 89)
set(CMAKE_CUDA_FLAGS "${CMAKE_CUDA_FLAGS} --expt-relaxed-constexpr")

find_package(CUDAToolkit REQUIRED)

# Try to find CUTLASS in parent directory first, then sibling
set(CUTLASS_PATHS
    "${CMAKE_CURRENT_SOURCE_DIR}/../../cutlass/include"
    "${CMAKE_CURRENT_SOURCE_DIR}/../../../cutlass/include"
    "/usr/local/cutlass/include"
)
find_path(CUTLASS_INCLUDE_DIR 
    NAMES cute/cute.hpp
    PATHS ${CUTLASS_PATHS}
)

if(NOT CUTLASS_INCLUDE_DIR)
    message(FATAL_ERROR "CUTLASS not found. Please ensure cutlass is installed.")
endif()

message(STATUS "CUTLASS found at: ${CUTLASS_INCLUDE_DIR}")

add_executable(project_01_vector_add vector_add.cu)

target_include_directories(project_01_vector_add PRIVATE
    ${CUTLASS_INCLUDE_DIR}
    ${CUDAToolkit_INCLUDE_DIRS}
)

target_link_libraries(project_01_vector_add PRIVATE CUDA::cudart)
